
<EditForm Model="@TaskObject" OnValidSubmit="@HandleValidSubmit">
    <div class="modal-body">
        <DataAnnotationsValidator />
        @if (Error == 0)
        {
            <div class="form-group">
                <label>Case Type Group</label>
                <div class="form-label-check">
                    <label>New</label>
                    <input type="checkbox" @bind-value="addNewCaseTypeGroupOption" />
                </div>
                @if (!addNewCaseTypeGroupOption)
                {
                    @if (LstAll_VmClientSmartflowRecord is null)
                    {
                        <div class="spinner"></div>
                    }
                    else
                    {

                        <InputSelect class="form-control" @bind-Value="TaskObject.CaseTypeGroup">

                            <option value=""></option>
                            @foreach (var c in LstAll_VmClientSmartflowRecord
                                           .Where(C => !(C.ClientSmartflowRecord.CaseTypeGroup is null))
                                           .Select(C => C.ClientSmartflowRecord.CaseTypeGroup)
                                           .Distinct()
                                           .ToList())
                                        {

                                <option value="@c">
                                    @c
                                </option>
                                        }
                        </InputSelect>

                        <ValidationMessage For="@(() => TaskObject.CaseTypeGroup)" />
                    }
                }
                else
                {

                    <InputText class="form-control" @bind-Value="TaskObject.CaseTypeGroup"></InputText>
                }


            </div>

            <div class="form-group">
                <label>Case Type</label>
                <div class="form-label-check">
                    <label>New</label>
                    <input type="checkbox" @bind-value="addNewCaseTypeOption" />
                </div>
                @if (!addNewCaseTypeOption)
                {

                    @if (LstAll_VmClientSmartflowRecord is null)
                    {
                        <div class="spinner"></div>
                    }
                    else
                    {
                        <InputSelect class="form-control" @bind-Value="TaskObject.CaseType">
                            <option value="">
                            </option>
                            @if (string.IsNullOrEmpty(TaskObject.CaseTypeGroup))
                                        {
                                @foreach (var c in LstAll_VmClientSmartflowRecord
                                        .Where(C => !(C.ClientSmartflowRecord.CaseType is null))
                                        .Select(C => C.ClientSmartflowRecord.CaseType)
                                        .Distinct()
                                        .ToList())
                                            {
                                    <option value="@c">
                                        @c
                                    </option>
                                            }
                                        }
                                        else
                                        {
                                @foreach (var c in LstAll_VmClientSmartflowRecord
                                          .Where(C => !(C.ClientSmartflowRecord.CaseType is null) && (C.ClientSmartflowRecord.CaseTypeGroup == TaskObject.CaseTypeGroup))
                                          .Select(C => C.ClientSmartflowRecord.CaseType)
                                          .Distinct()
                                          .ToList())
                                            {
                                    <option value="@c">
                                        @c
                                    </option>
                                            }
                                        }
                        </InputSelect>

                        <ValidationMessage For="@(() => TaskObject.CaseType)" />
                    }

                }
                else
                {
                    <InputText class="form-control" @bind-Value="TaskObject.CaseType"></InputText>

                }


            </div>

            <div class="form-group">
                <label>Smartflow Name</label>
                <InputText class="form-control" @bind-Value="TaskObject.SmartflowName"></InputText>
                <ValidationMessage For="@(() => TaskObject.SmartflowName)" />
            </div>
        }
        else
        {
            <div class="form-group">
                <label>A smartflow already exists with this name in @TaskObject.CaseType. Do you still wish to create this smartflow? </label>
            </div>
        }

    </div>
    <div class="button-container">
        @if (Error == 0)
        {
            <button type="submit" class="btn btn-main">Save</button>
            <button type="button" class="btn btn-secondary" data-dismiss="modal" @onclick="Close">Cancel</button>

            @if (TaskObject.Id != 0)
            {
                <button type="button" @onclick="HandleValidDelete" class="btn btn-danger">Delete</button>
            }
        }
        else
        {
            <button type="button" @onclick="CreateSmartFlow" class="btn btn-main">Create</button>
            <button type="button" class="btn btn-secondary" data-dismiss="modal" @onclick="Close">Cancel</button>
        }

    </div>

</EditForm>